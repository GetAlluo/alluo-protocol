Case 1:

L1 Insufficient funds to deposit

L2 Withdraw and bridge

L1 deposits

- L1
    
    Commands with Mainnet only
    
    Withdraw first and hold deposits
    
    While withdrawing, check balance of usdc
    
    While sufficient, deposit.
    
    If not sufficient, stasis mode until sufficient funds. Send L2 data, include “bridge command”
    
- L2:
    
    Commands with L2 only
    
    Withdraw first and hold deposits
    
    While withdrawing check balacne
    
    Deposit what you need and use return command to send required balance back to L1
    
    -Just bridge, no need to use any call.
    
- L1:
    
    Remaining deposit commands (no withdrawals needed)
    
    Deposit the rest of the funds once sufficient.
    

Required Commands:

L1: All required total values

“Pool Address” “Ethereum” “100k”

 “Pool Address” “Polygon” “200k”

Calculate all deltas and carry out withdrawals first.
- USD -1 Strategy--> 
- USD 3 strategies on one chain 

If all deposits cannot be carried out simultaenously (Deposit delta sum > balance of USDC), send bridge command to L2 + L2 commands. Enter stasis mode with deposit commands in a mapping.
100k usdc --> need 200k to put in the pool 


L2: All L2 comands + bridge command at the end

Calculate all deltas and carry out withdrawals

Do deposits if needed

Use bridge command to bridge back

L1: Whenever the funds are back, just have a function to execute all the deposits in queue

 
 
L1:  Strategy Curve: 500k --- > 700k  (+200k)

L2:  Strategy Harvest: 700k --> 500k (-200k)

L1: 50% in Strategy Curve. We need to know the total amount
--> add across all the chains. Very difficult.





Case 2:

L1 Sufficient funds to deposit

L2 Withdraw and deposits

- L1:
    
    Commands with mainnet only, include bridgeL2 command
    
    Withdraw first and deposit if needed
    
    Bridge funds to L2 using command
    
- L2:
    
    Commands with L2 only (no bridgeL1 command)
    
    Withdraw first and deposit if possible.
    
    If insufficient funds, go into stasis until balance is met.
    
    Stasis mode until rest of funds are bridged
    

Required Commands:

L1: All required total values

“Pool Address” “Ethereum” “100k”

 “Pool Address” “Polygon” “200k”

“Bridge” “Polygon” “100k”

Calculate all deltas and carry out withdrawals first.

All deposits are carried out.

100k USDC balance bridged using bridge function

L2: All L2 commands

Calculate all deltas and carry out withdrawals

If all deposits are simultaneously possible, do that, otherwise, enter stasis mode while waiting for bridged funds

When bridged funds arrive/ bal required is met, deposit all.

[https://docs.multichain.org/developer-guide/anycall/bridge-funds-and-anycall](https://docs.multichain.org/developer-guide/anycall/bridge-funds-and-anycall)

Polygon Bridge